import requests 
import xml.etree.ElementTree as ET
from bs4 import BeautifulSoup as Soup

# url path of spdisco.aspx file (This is a web service discovery file listing out the names and locations of all of SharePoint's web service endpoints)
url = "https://www.x.com/_vti_bin/spdisco.aspx"
r = requests.get(url)
tree = ET.fromstring(r.content)
wsdlFiles = []
# just iterate over each element
for elem in tree:
	if "contractRef" in elem.tag:
		#print(elem.attrib["ref"])
		wsdlFiles.append(elem.attrib["ref"])
print("[+] List of WSDL files extracted from the spdisco.aspx: ")
for file in wsdlFiles:
	print(file)
# Defining burp proxy 
proxies = {'http':'http://127.0.0.1:8080','https':'http://127.0.0.1:8080'}
# send a GET request for each WSDL file (proxied to Burp)
for file in wsdlFiles:
	r = requests.get(file,verify=False, proxies=proxies)
